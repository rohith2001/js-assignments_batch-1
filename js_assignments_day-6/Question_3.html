<!DOCTYPE html>
<html>
<head>
	<title>JavaScript Assignment_Batch_1_Day6_Question3</title>
</head>
<body>
	<script type="text/javascript">
		//promises
        console.log("Promises");

let users = [
    {
        name:'Neha',
        email:'neha@gmail.com',
    },
    {
        name:'Rohith',
        email:'rohith@gmail.com',
    },
    {
        name:'Ankith',
        email:'ankith@gmail.com',
    },
]


function getUsers(){
    setTimeout(()=>{
        let result = '';
        users.forEach(user=>{
            result += `The user is ${user.name} \n`;
        });
        console.log(result);
    },1000);
}

function createUser(user, callback){
    setTimeout(()=>{
         users.push(user);
         callback();
     },3000);
 }

getUsers();
createUser({name:'raj',email:'chiluka@gmail.com'}, getUsers);


function createUser(user){
    return new Promise((resolve, reject)=>{
         setTimeout(()=>{
             users.push(user);

            const error = false;

             if(!error){
                 resolve();
             }
             else{
                 reject("Oops an error occured");
             }

         }, 3000);
     })
 }


 createUser({name:'uttej',email:'rahul@gmail.com'})
 .then(getUsers)
 .catch(error=>console.log(error));

const userData = new Promise((resolve,reject)=>{
   const error = false;

     if(error){
         reject("an error occured");
     }
     else{
         resolve({
             firstname:"Rahul",
             age:19,
             class:'12th',
         })
     }


 });
userData
     .then(data=>console.log(data))
     .catch(error=>console.log(error))


  //Async Await

console.log("Async Await");
const photos = [];
async function photoUpload(){
    let status = new Promise((resolve, reject)=>{
        setTimeout(()=>{
            photos.push('Avatar');
            resolve('Profile Updated');
        },3000)
    })

    let result = await status;
    console.log(photos.length);
}

photoUpload();
photoUpload();
photoUpload();




//Fetch Api
console.log('Fetch API');

// https://jsonplaceholder.typicode.com/comments

// Making a get request
fetch('https://jsonplaceholder.typicode.com/posts')
.then(response=>response.json())
.then(data=>console.log(data))

let obj = {
    userId:254,
    title:"Some Title",
    body:'lorem ipsum',
}

// Make a post Request
fetch('https://jsonplaceholder.typicode.com/posts',{
    method:'POST',
    body: JSON.stringify(obj)
}).then(response=>response.json())
.then(data=>console.log(data))



async function fetchMovies(){
    //const response = await fetch('https://jsonplaceholder.typicode.com/todos/1')
    const response = await fetch('https://jsonplaceholder.typicode.com/todos ')
    const data = await response.json();

    console.log(data);
}

fetchMovies();


let movie1 = {
    name:'KGF',
    collection:12,
    canDrive:true,
}

console.log(movie1);
let str = JSON.stringify(movie1);
console.log(str)

let strmov = JSON.parse(str);
console.log(strmov)



	</script>

</body>
</html>